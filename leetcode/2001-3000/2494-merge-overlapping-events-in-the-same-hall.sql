# Write your MySQL query statement below
with cte1 as (select * from HallEvents order by hall_id asc, start_day asc, end_day asc), cte2 as (select hall_id, @pre_start := if(hall_id = @pre_id and @pre_end is not null and @pre_end >= start_day, @pre_start, start_day) as start_day, @pre_end := if(hall_id = @pre_id and @pre_end is not null and @pre_end > end_day, @pre_end, end_day) as end_day, @pre_id := hall_id from cte1, (select @pre_id := null, @pre_start := null, @pre_end := null) as tmp) select hall_id, start_day, max(end_day) as end_day from cte2 group by hall_id, start_day
