# Write your MySQL query statement below
select A.team_name, count(B.point) as matches_played, ifnull(sum(B.point), 0) as points, ifnull(sum(B.goal_win), 0) as goal_for, ifnull(sum(B.goal_lose), 0) as goal_against, ifnull(sum(B.goal_win) - sum(B.goal_lose), 0) as goal_diff from Teams A inner join ((select home_team_id as team_id, (case when home_team_goals > away_team_goals then 3 when home_team_goals < away_team_goals then 0 else 1 end) as point, home_team_goals as goal_win, away_team_goals as goal_lose from Matches) union all (select away_team_id as team_id, (case when home_team_goals > away_team_goals then 0 when home_team_goals < away_team_goals then 3 else 1 end) as point, away_team_goals as goal_win, home_team_goals as goal_lose from Matches)) B on A.team_id = B.team_id group by A.team_id order by points desc, goal_diff desc, team_name asc;
