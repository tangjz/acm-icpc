# Write your MySQL query statement below
select (T3.rnk - 1) as transactions_count, count(T1.user_id) as visits_count from (select @upp := ifnull(max(cnt), 0) from (select count(B.amount) as cnt from Visits A left join Transactions B on A.user_id = B.user_id and A.visit_date = B.transaction_date group by A.user_id, A.visit_date) T1) T2, (json_table(concat('[{}', repeat(',{}', @upp), ']'), '$[*]' columns(rnk for ordinality)) T3 left join (select A.user_id, A.visit_date, count(B.amount) as cnt from Visits A left join Transactions B on A.user_id = B.user_id and A.visit_date = B.transaction_date group by A.user_id, A.visit_date) T1 on T3.rnk - 1 = T1.cnt) group by T3.rnk;
