# Write your MySQL query statement below
with A as (select * from json_table('[{},{},{},{},{},{},{},{},{},{},{},{}]', '$[*]' columns(month for ordinality)) T), B as (select A.month, count(distinct T2.driver_id) as accepted_drivers from A left join (Rides T1 inner join AcceptedRides T2 on T1.ride_id = T2.ride_id) on A.month = month(T1.requested_at) and year(T1.requested_at) = 2020 group by A.month), C as (select A.month, count(T.driver_id) as active_drivers from A left join Drivers T on year(T.join_date) < 2020 or (year(T.join_date) = 2020 and month(T.join_date) <= A.month) group by A.month) select B.month, round(ifnull(100 * B.accepted_drivers / C.active_drivers, 0), 2) as working_percentage from B inner join C on B.month = C.month order by B.month;
