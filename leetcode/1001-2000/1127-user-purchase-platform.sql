# Write your MySQL query statement below
select A.spend_date, A.type as platform, ifnull(sum(T.sum_amount), 0) as total_amount, count(T.user_id) as total_users from ((select distinct(spend_date) as spend_date, 'desktop' as type from Spending) union (select distinct(spend_date) as spend_date, 'mobile' as type from Spending) union (select distinct(spend_date) as spend_date, 'both' as type from Spending)) A left join (select user_id, spend_date, (case when sum(platform = 'desktop') = 0 then 'mobile' when sum(platform = 'mobile') = 0 then 'desktop' else 'both' end) as type, sum(amount) as sum_amount from Spending group by spend_date, user_id) T on A.spend_date = T.spend_date and A.type = T.type group by A.spend_date, A.type;
